# 資格檢核器快速開始指南

## 使用流程

### 步驟 1: 啟動應用程式

```bash
streamlit run app.py
```

### 步驟 2: 匯入測試資料

1. 點擊側邊欄的「資格檢核器」
2. 切換到「📥 資料匯入」頁籤
3. 依序匯入以下測試資料：

#### 2.1 匯入員工資料
- 點擊「員工資料」子頁籤
- 上傳檔案：`tests/test_data/test_m5_employee_master.xlsx`
- 點擊「匯入員工資料」
- 應顯示：✅ 成功匯入 8/8 筆員工資料

#### 2.2 匯入離職記錄
- 點擊「離職記錄」子頁籤
- 上傳檔案：`tests/test_data/test_m5_separation.xlsx`
- 點擊「匯入離職記錄」
- 應顯示：✅ 成功匯入 8/8 筆離職記錄

#### 2.3 匯入績效資料
- 點擊「績效資料」子頁籤
- 上傳檔案：`tests/test_data/test_m5_performance.xlsx`
- 點擊「匯入績效資料」
- 應顯示：✅ 成功匯入 25/25 筆績效資料

#### 2.4 匯入訓練記錄
- 點擊「訓練記錄」子頁籤
- 上傳檔案：`tests/test_data/test_m5_training.xlsx`
- 點擊「匯入訓練記錄」
- 應顯示：✅ 成功匯入 51/51 筆訓練記錄

---

### 步驟 3: 執行資格檢核

1. 切換回「📋 資格檢核」頁籤
2. 應該看到：📊 資料庫中共有 8 位員工記錄
3. 從下拉選單選擇要檢核的員工

#### 測試案例 1: 自動核准
- 選擇：`E001 - 張志明 (研發部)`
- 輸入身分證字號：`A123456789`
- 點擊「🔍 執行檢核」
- **預期結果**：✅ 建議核准
  - 所有檢核項目通過
  - 不需要 AI 輔助（節省成本）

#### 測試案例 2: 需要審查（可選擇 AI）
- 選擇：`E004 - 王大明 (業務部)`
- 輸入身分證字號：`D456789012`
- 點擊「🔍 執行檢核」
- **預期結果**：⚠️ 需要審查
  - 顯示警示：曾有 2 次低績效紀錄
  - 顯示「🤖 AI 輔助判斷」按鈕
  - 可選擇是否使用 AI 分析

#### 測試案例 3: 自動拒絕
- 選擇：`E006 - 陳不良 (財務部)`
- 輸入身分證字號：`F678901234`
- 點擊「🔍 執行檢核」
- **預期結果**：❌ 不建議核准
  - 黑名單檢查失敗
  - 拒絕原因：列於黑名單中，不得回任
  - 不需要 AI（規則明確）

---

### 步驟 4: 使用 AI 輔助判斷（選用）

如果要測試 AI 功能：

1. 切換到「⚙️ AI 設定」頁籤
2. 輸入您的 Gemini API Key
3. 點擊「💾 儲存設定」
4. 系統會自動測試連接
5. 返回「資格檢核」頁籤
6. 檢核有警示項目的員工（如 E004）
7. 點擊「🚀 使用 AI 輔助判斷」

---

## 完整測試清單

| 員工編號 | 姓名 | 身分證字號 | 預期結果 | 說明 |
|---------|------|-----------|---------|------|
| E001 | 張志明 | A123456789 | ✅ 核准 | 優良績效，自願離職 |
| E002 | 林美玲 | B234567890 | ✅ 核准 | 良好記錄 |
| E003 | John Chen | C345678901 | ✅ 核准 | 乾淨記錄 |
| E004 | 王大明 | D456789012 | ⚠️ 審查 | 低績效但後期改善 |
| E005 | 李小華 | E567890123 | ⚠️ 審查 | 早期低績效 |
| E006 | 陳不良 | F678901234 | ❌ 拒絕 | 黑名單（違規） |
| E007 | 黃違規 | G789012345 | ❌ 拒絕 | 黑名單（誠信） |
| E008 | 劉被資遣 | H890123456 | ⚠️ 審查 | 非自願離職 |

---

## 匯出檢核報告

1. 執行檢核後，向下滾動到「匯出報告」區域
2. 點擊「💾 下載檢核報告」
3. 下載的 Excel 檔案包含兩個分頁：
   - 檢核摘要：整體結果和建議
   - 檢核明細：所有檢核項目的詳細資訊

---

## 常見問題

### Q: 看不到員工清單怎麼辦？
A: 請確認已經匯入「員工資料」。如果已匯入，請重新整理頁面。

### Q: 匯入資料時出現錯誤？
A: 請檢查：
1. Excel 檔案中的欄位名稱是否正確
2. 檔案格式是否為 .xlsx
3. 資料中是否有缺少必填欄位

### Q: AI 功能無法使用？
A: 請確認：
1. 已在「AI 設定」頁面設定 API Key
2. API Key 有效且未過期
3. 有網路連接

### Q: 如何清空測試資料？
A: 可以到各個模組的「資料庫管理」功能清空：
- 員工查詢 → 資料庫管理 → 清空資料庫
- 或直接刪除 `data/*.db` 檔案後重啟應用程式

---

## 成本優化驗證

完成所有 8 個測試案例後，檢視「📊 使用統計」頁籤：
- 如果沒有使用 AI 功能，應該是 0 次呼叫
- 如果對 3 個審查案例都使用 AI，應該是 3 次呼叫
- 這證明了混合式策略：**只有 37.5% 的案例可能需要 AI**

---

## 下一步

測試完成後，您可以：
1. 查看「📊 使用統計」了解 API 使用情況
2. 嘗試修改測試資料創建新的測試場景
3. 整合到實際的 HR 工作流程中

有問題請參考 `M5_TEST_GUIDE.md` 詳細文件。
